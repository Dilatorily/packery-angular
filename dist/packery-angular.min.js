!function(e,t,n){"use strict";function a(){return{columnWidth:1,dragSelector:"",isAppended:!0,isDraggable:!0,itemSelector:".pa-item",percentPosition:!1,rowHeight:1,stamp:".pa-stamp"}}function r(){return{DESTROYED:"$paDestroyed",DRAGGED:"$paDragItemPositioned",FITTED:"$paFitComplete",INITIALIZED:"$paInitialized",ITEM:{ADDED:"$paItemAdded",DESTROYED:"$paItemDestroyed"},LAYOUT_COMPLETED:"$paLayoutComplete",PACKERY:{DRAGGED:"dragItemPositioned",FITTED:"fitComplete",LAYOUT_COMPLETED:"layoutComplete",REMOVE:"removeComplete"},REMOVE:"$paRemoveComplete"}}function o(t,n,a,r,o,i,c,p){function s(e){m.then(function(){t.isAppended?k.packery.appended(e):k.packery.preprended(e),t.draggabilly.isDraggable&&E(e),t.$emit(c.ITEM.ADDED,{element:e,hash:$,packery:k.packery}),u()})}function y(e){m.then(function(){f&&(k.packery.remove(e),t.$emit(c.ITEM.DESTROYED,{element:e,hash:$,packery:k.packery}),u())})}function d(){t.$on("$destroy",function(e){f=!0,m.then(function(){k.packery.destroy(),t.$emit(c.DESTROYED,{event:e,hash:$,packery:k.packery})})})}function l(){function n(){var n;for(n in p)p.hasOwnProperty(n)&&!t.options.hasOwnProperty(n)&&(t.options[n]=e.copy(p[n]))}function a(){t.isAppended=t.options.isAppended,delete t.options.isAppended}function r(){t.draggabilly={dragSelector:t.options.dragSelector,isDraggable:t.options.isDraggable},delete t.options.dragSelector,delete t.options.isDraggable}t.options=t.packery?e.copy(t.packery):{},n(),a(),r()}function D(){function e(){var e,a=n[0].children;if(t.draggabilly.isDraggable)for(e=0;e<a.length;++e)E(a[e])}function a(){k.packery.on(c.PACKERY.LAYOUT_COMPLETED,function(e){t.$emit(c.LAYOUT_COMPLETED,{hash:$,laidOutItems:e,packery:k.packery})}),k.packery.on(c.PACKERY.DRAGGED,function(e){t.$emit(c.DRAGGED,{draggedItem:e,hash:$,packery:k.packery})}),k.packery.on(c.PACKERY.FITTED,function(e){t.$emit(c.FITTED,{hash:$,item:e,packery:k.packery})}),k.packery.on(c.PACKERY.REMOVED,function(e){t.$emit(c.REMOVED,{hash:$,packery:k.packery,removedItems:e})})}k.packery=new o(n[0],t.options),t.$emit(c.INITIALIZED,{hash:$,packery:k.packery}),e(),a(),g.resolve()}function E(e){var n=new i(e,{handle:t.draggabilly.dragSelector});k.packery.bindDraggabillyEvents(n)}function u(){m.then(function(){r(function(){k.packery.layout()})})}var k=this,g=a.defer(),m=g.promise,f=!1,$=(new Date).getTime();k.packery=void 0,k.add=s,k.remove=y,d(),l(),r(D)}function i(){return{controller:"paPackery",restrict:"A",scope:{packery:"=?paPackery"}}}function c(){function e(e,t,n,a){a.packery&&a.add(t[0]),e.$on("$destroy",function(){a.remove(t[0])})}return{link:e,require:"^paPackery",restrict:"A"}}e.module("packery-angular",[]).constant("Draggabilly",t).constant("Packery",n).constant("$paOptions",a()).constant("$paEvents",r()).controller("paPackery",o).directive("paPackery",i).directive("paPackeryItem",c),o.$inject=["$scope","$element","$q","$timeout","Packery","Draggabilly","$paEvents","$paOptions"],c.$inject=["$paEvents"]}(window.angular,window.Draggabilly,window.Packery);