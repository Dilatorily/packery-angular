!function(e,n,t){"use strict";function a(){return{columnWidth:1,dragSelector:"",isAppended:!0,isDraggable:!0,itemSelector:".pa-item",percentPosition:!1,rowHeight:1,stamp:".pa-stamp"}}function o(){return{DESTROYED:"$paDestroyed",DRAGGED:"$paDragItemPositioned",FITTED:"$paFitComplete",INITIALIZED:"$paInitialized",ITEM:{ADDED:"$paItemAdded",DESTROYED:"$paItemDestroyed"},LAYOUT_COMPLETED:"$paLayoutComplete",PACKERY:{DRAGGED:"dragItemPositioned",FITTED:"fitComplete",LAYOUT_COMPLETED:"layoutComplete",REMOVE:"removeComplete"},REMOVE:"$paRemoveComplete"}}function r(n,t,a,o,r,i,c,p){function d(e){k.then(function(){n.isAppended?g.packery.appended(e):g.packery.prepended(e),n.draggabilly.isDraggable&&E(e),n.$emit(c.ITEM.ADDED,$,g.packery,e),u()})}function l(e){k.then(function(){m||(g.packery.remove(e),n.$emit(c.ITEM.DESTROYED,$,g.packery,e),u())})}function y(){n.$on("$destroy",function(e){m=!0,k.then(function(){g.packery.destroy(),n.$emit(c.DESTROYED,$,g.packery,e)})})}function s(){function t(){var t;for(t in p)p.hasOwnProperty(t)&&!n.options.hasOwnProperty(t)&&(n.options[t]=e.copy(p[t]))}function a(){n.isAppended=n.options.isAppended,delete n.options.isAppended}function o(){n.draggabilly={dragSelector:n.options.dragSelector,isDraggable:n.options.isDraggable},delete n.options.dragSelector,delete n.options.isDraggable}n.options=n.packery?e.copy(n.packery):{},t(),a(),o()}function D(){function e(){var e,a=t[0].children;if(n.draggabilly.isDraggable)for(e=0;e<a.length;++e)E(a[e])}function a(){g.packery.on(c.PACKERY.LAYOUT_COMPLETED,function(e){n.$emit(c.LAYOUT_COMPLETED,$,g.packery,e)}),g.packery.on(c.PACKERY.DRAGGED,function(e){n.$emit(c.DRAGGED,$,g.packery,e)}),g.packery.on(c.PACKERY.FITTED,function(e){n.$emit(c.FITTED,$,g.packery,e)}),g.packery.on(c.PACKERY.REMOVED,function(e){n.$emit(c.REMOVED,$,g.packery,e)})}g.packery=new r(t[0],n.options),n.$emit(c.INITIALIZED,$,g.packery),e(),a(),f.resolve()}function E(e){var t=new i(e,{handle:n.draggabilly.dragSelector});g.packery.bindDraggabillyEvents(t)}function u(){k.then(function(){o(function(){g.packery.layout()})})}var g=this,f=a.defer(),k=f.promise,m=!1,$=(new Date).getTime();g.packery=void 0,g.add=d,g.remove=l,y(),s(),o(D)}function i(){return{controller:"paPackery",restrict:"A",scope:{packery:"=?paPackery"}}}function c(){function e(e,n,t,a){a.packery&&a.add(n[0]),e.$on("$destroy",function(){a.remove(n[0])})}return{link:e,require:"^paPackery"}}e.module("packery-angular",[]).constant("Draggabilly",n).constant("Packery",t).constant("$paOptions",a()).constant("$paEvents",o()).controller("paPackery",r).directive("paPackery",i).directive("paPackeryItem",c),r.$inject=["$scope","$element","$q","$timeout","Packery","Draggabilly","$paEvents","$paOptions"],c.$inject=["$paEvents"]}(window.angular,window.Draggabilly,window.Packery);